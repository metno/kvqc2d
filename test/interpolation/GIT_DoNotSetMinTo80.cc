
#include "GapInterpolationTestBase.hh"

TEST_F(GapInterpolationTest, DoNotSetMinTo80_1)
{
    std::ostringstream sql;
    INSERT_STATION(sql, 64760, "SURNADAL - SYLTE",            62.985,  8.690,    5);
    ASSERT_NO_THROW_X(db->exec(sql.str()));

    DataList data(64760, 211, 502);
    data.add("2013-09-21 15:00:00",      13.6,      13.6, "0111100000100010", "")
        .add("2013-09-21 16:00:00",      13.2,      13.2, "0111100000100010", "")
        .add("2013-09-21 17:00:00",      12.2,      12.2, "0111100000100010", "")
        .add("2013-09-21 18:00:00",       9.4,       9.4, "0111100000100010", "")
        .add("2013-09-21 19:00:00",  -32767.0,       9.6, "0000601000000000", "QC1-4-211")
        .add("2013-09-21 20:00:00",       8.3,       8.3, "0110100000100010", "")
        .add("2013-09-21 21:00:00",       7.0,       7.0, "0111100000100010", "")
        .add("2013-09-21 22:00:00",       6.7,       6.7, "0111100000100010", "")
        .add("2013-09-21 23:00:00",       6.5,       6.5, "0111100000100010", "")
        .add("2013-09-22 00:00:00",       5.9,       5.9, "0111100000100010", "");
    data.setParam(213)
        .add("2013-09-21 16:00:00",      12.8,      12.8, "0111100000000010", "")
        .add("2013-09-21 17:00:00",      12.2,      12.2, "0111100000000010", "")
        .add("2013-09-21 18:00:00",       9.4,       9.4, "0111100000000010", "")
        .add("2013-09-21 19:00:00",  -32767.0,  -32767.0, "0000103300000000", "QC2d-2-I")
        .add("2013-09-21 20:00:00",       8.0,       8.0, "0110100000000010", "")
        .add("2013-09-21 21:00:00",       6.8,       6.8, "0111100000000010", "")
        .add("2013-09-21 22:00:00",       6.4,       6.4, "0111100000000010", "")
        .add("2013-09-21 23:00:00",       6.4,       6.4, "0111100000000010", "")
        .add("2013-09-22 00:00:00",       5.8,       5.8, "0111100000000010", "");
    data.setParam(215)
        .add("2013-09-21 16:00:00",      13.6,      13.6, "0111100000000010", "")
        .add("2013-09-21 17:00:00",      13.2,      13.2, "0111100000000010", "")
        .add("2013-09-21 18:00:00",      12.2,      12.2, "0111100000000010", "")
        .add("2013-09-21 19:00:00",  -32767.0,  -32767.0, "0000103300000000", "QC2d-2-I")
        .add("2013-09-21 20:00:00",       8.6,       8.6, "0110100000000010", "")
        .add("2013-09-21 21:00:00",       8.3,       8.3, "0111100000000010", "")
        .add("2013-09-21 22:00:00",       7.0,       7.0, "0111100000000010", "")
        .add("2013-09-21 23:00:00",       6.7,       6.7, "0111100000000010", "")
        .add("2013-09-22 00:00:00",       6.5,       6.5, "0111100000000010", "");
    ASSERT_NO_THROW(data.insert(db));

    std::stringstream config;
    config << "Start_YYYY = 2013\n"
           << "Start_MM   =   09\n"
           << "Start_DD   =   21\n"
           << "Start_hh   =   15\n"
           << "End_YYYY   = 2013\n"
           << "End_MM     =   09\n"
           << "End_DD     =   22\n"
           << "End_hh     =   00\n"
           << "TypeId     =  502\n"
           << "Parameter  = par=211,minPar=213,maxPar=215,minVal=-80,maxVal=100,offsetCorrectionLimit=15,fluctuationLevel=0\n";
    AlgorithmConfig params;
    params.Parse(config);
    ASSERT_CONFIGURE(algo, params);
 
    const int N = 3;
    ASSERT_RUN(algo, bc, N);
    const float expectedC[N] = { 8.8, 7.5, 9.6 };
    const float expectedP[N] = { 211, 213, 215 };
    for(int i=0; i<N; ++i) {
        EXPECT_NEAR(expectedC[i], bc->update(i).corrected(), i==0 ? 0.1 : 1) << "i=" << i;
        EXPECT_EQ(expectedP[i], bc->update(i).paramID()) << "i=" << i;
    }
    ASSERT_RUN(algo, bc, 0);
}
// ------------------------------------------------------------------------

TEST_F(GapInterpolationTest, DoNotSetMinTo80_2)
{
    std::ostringstream sql;
    INSERT_NEIGHBOR(sql, 18500, 211, 18700, -2.465910,  0.985017,  1.408790);
    INSERT_NEIGHBOR(sql, 18500, 211,  4460, -0.515014,  0.935402,  1.455160);
    INSERT_NEIGHBOR(sql, 18500, 211,  4780, -0.760737,  0.948524,  1.475140);
    INSERT_NEIGHBOR(sql, 18500, 211, 18230, -1.795520,  0.933439,  1.508610);
    INSERT_NEIGHBOR(sql, 18500, 211, 26990, -1.857910,  0.965352,  1.642950);
    INSERT_NEIGHBOR(sql, 18500, 211, 20301, -0.984970,  0.908082,  1.651520);
    INSERT_NEIGHBOR(sql, 18500, 211,  4200, -0.980338,  0.912024,  1.686730);
    INSERT_NEIGHBOR(sql, 18500, 211, 17850, -1.468600,  0.963223,  1.733860);
    INSERT_NEIGHBOR(sql, 18500, 211,  5590, -0.739181,  0.934320,  1.738670);
    INSERT_NEIGHBOR(sql, 18500, 211, 27010, -0.790339,  0.942783,  1.753700);
    INSERT_NEIGHBOR(sql, 18500, 211, 28380, -0.654998,  0.906370,  1.789180);
    INSERT_NEIGHBOR(sql, 18500, 211, 27450, -2.633290,  0.999367,  1.789650);
    INSERT_NEIGHBOR(sql, 18500, 211,  4920,  0.052496,  0.910478,  1.790120);
    INSERT_NEIGHBOR(sql, 18500, 211,  5660, -0.523979,  0.904101,  1.801610);
    INSERT_NEIGHBOR(sql, 18500, 211, 27470, -2.830620,  1.012630,  1.810250);
    INSERT_NEIGHBOR(sql, 18500, 211, 26900, -1.427500,  0.902624,  1.837460);
    INSERT_NEIGHBOR(sql, 18500, 211,  2650, -0.770164,  0.944724,  1.843460);
    INSERT_NEIGHBOR(sql, 18500, 211, 17150, -2.606950,  0.992392,  1.858930);
    INSERT_NEIGHBOR(sql, 18500, 211, 11500, -0.367157,  0.950267,  1.862430);
    INSERT_NEIGHBOR(sql, 18500, 211,  6020, -0.445568,  0.907007,  1.877440);
    INSERT_NEIGHBOR(sql, 18500, 211, 30420, -2.108140,  1.000460,  1.906510);
    INSERT_NEIGHBOR(sql, 18500, 211, 12290, -0.281080,  0.885070,  1.923760);
    INSERT_NEIGHBOR(sql, 18500, 211, 12320, -0.385481,  0.929617,  1.924150);
    INSERT_NEIGHBOR(sql, 18500, 211, 18210, -1.710950,  0.859356,  1.932080);
    INSERT_NEIGHBOR(sql, 18500, 211,  3290, -1.619560,  0.970344,  1.966240);
    INSERT_NEIGHBOR(sql, 18500, 211, 32060, -1.617300,  0.960270,  1.979700);
    INSERT_NEIGHBOR(sql, 18500, 211, 24710, -0.311898,  0.876479,  2.066970);
    INSERT_NEIGHBOR(sql, 18500, 211, 12680,  0.390295,  0.888795,  2.079670);
    INSERT_NEIGHBOR(sql, 18500, 211, 18950, -0.124572,  1.044000,  2.102120);
    INSERT_NEIGHBOR(sql, 18500, 211, 12550, -0.420946,  0.939294,  2.147100);
    INSERT_NEIGHBOR(sql, 18500, 211, 27270, -3.076180,  0.957330,  2.151260);
    INSERT_NEIGHBOR(sql, 18500, 211, 17280, -3.659230,  1.042190,  2.153730);
    INSERT_NEIGHBOR(sql, 18500, 211, 23420,  1.081010,  0.868501,  2.174020);
    INSERT_NEIGHBOR(sql, 18500, 211, 28922, -0.187009,  0.920946,  2.213310);
    INSERT_NEIGHBOR(sql, 18500, 211, 30650, -0.519317,  0.858703,  2.250970);
    INSERT_NEIGHBOR(sql, 18500, 211, 23500,  1.633280,  0.921659,  2.326720);
    INSERT_NEIGHBOR(sql, 18500, 211, 23410,  2.495900,  0.957673,  2.361970);
    INSERT_NEIGHBOR(sql, 18500, 211, 24890,  1.113000,  0.821026,  2.386280);
    INSERT_NEIGHBOR(sql, 18500, 211, 34130, -4.492760,  1.094930,  2.507630);
    INSERT_NEIGHBOR(sql, 18500, 211, 29720,  2.693400,  0.960709,  2.640180);
    INSERT_NEIGHBOR(sql, 18500, 211, 25110,  1.788780,  0.932625,  2.642930);
    INSERT_NEIGHBOR(sql, 18500, 211, 31620,  2.582130,  1.043220,  2.661930);
    INSERT_NEIGHBOR(sql, 18500, 211, 17980, -1.857540,  0.575450,  2.673020);
    INSERT_NEIGHBOR(sql, 18500, 211, 17000, -4.165020,  1.062490,  2.685500);
    INSERT_NEIGHBOR(sql, 18500, 211, 18815, -2.886640,  0.517276,  2.694630);
    INSERT_NEIGHBOR(sql, 18500, 211, 29950, -4.247710,  1.077560,  2.769150);
    INSERT_NEIGHBOR(sql, 18500, 211, 25630,  2.052600,  0.986172,  2.868570);
    INSERT_NEIGHBOR(sql, 18500, 211, 27500, -4.753740,  1.085800,  2.920660);
    INSERT_STATION(sql,  2650, "AURSKOG II",                  59.912, 11.580,  128);
    INSERT_STATION(sql,  3290, "RAKKESTAD",                   59.386, 11.387,  100);
    INSERT_STATION(sql,  4200, "KJELLER",                     59.971, 11.038,  109);
    INSERT_STATION(sql,  4460, "HAKADAL JERNBANESTASJON",     60.117, 10.829,  170);
    INSERT_STATION(sql,  4780, "GARDERMOEN",                  60.206, 11.080,  202);
    INSERT_STATION(sql,  4920, "ÅRNES",                       60.127, 11.393,  160);
    INSERT_STATION(sql,  5590, "KONGSVINGER",                 60.190, 12.007,  148);
    INSERT_STATION(sql,  5660, "ROVERUD",                     60.254, 12.091,  150);
    INSERT_STATION(sql,  6020, "FLISA II",                    60.614, 12.012,  185);
    INSERT_STATION(sql, 11500, "ØSTRE TOTEN - APELSVOLL",     60.700, 10.870,  264);
    INSERT_STATION(sql, 12290, "HAMAR II",                    60.801, 11.098,  132);
    INSERT_STATION(sql, 12320, "HAMAR - STAVSBERG",           60.818, 11.070,  221);
    INSERT_STATION(sql, 12550, "KISE PA HEDMARK",             60.773, 10.806,  128);
    INSERT_STATION(sql, 12680, "LILLEHAMMER - SÆTHERENGEN",   61.093, 10.477,  240);
    INSERT_STATION(sql, 17000, "STRØMTANGEN FYR",             59.151, 10.829,   10);
    INSERT_STATION(sql, 17150, "RYGGE",                       59.379, 10.775,   40);
    INSERT_STATION(sql, 17280, "GULLHOLMEN",                  59.435, 10.578,   14);
    INSERT_STATION(sql, 17850, "ÅS",                          59.660, 10.782,   89);
    INSERT_STATION(sql, 17980, "OSLO - LJABRUVEIEN",          59.843, 10.824,   92);
    INSERT_STATION(sql, 18210, "OSLO - HOVIN",                59.923, 10.804,  100);
    INSERT_STATION(sql, 18230, "ALNA",                        59.927, 10.835,   90);
    INSERT_STATION(sql, 18500, "BJØRNHOLT",                   60.051, 10.688,  360);
    INSERT_STATION(sql, 18700, "OSLO - BLINDERN",             59.942, 10.720,   94);
    INSERT_STATION(sql, 18815, "OSLO - BYGDØY",               59.905, 10.683,   15);
    INSERT_STATION(sql, 18950, "TRYVANNSHØGDA",               59.985, 10.669,  514);
    INSERT_STATION(sql, 20301, "HØNEFOSS - HØYBY",            60.166, 10.248,  140);
    INSERT_STATION(sql, 23410, "FAGERNES LUFTHAVN",           61.013,  9.293,  822);
    INSERT_STATION(sql, 23420, "FAGERNES",                    60.987,  9.237,  365);
    INSERT_STATION(sql, 23500, "LØKEN I VOLBU",               61.122,  9.063,  521);
    INSERT_STATION(sql, 24710, "GULSVIK II",                  60.383,  9.605,  142);
    INSERT_STATION(sql, 24890, "NESBYEN - TODOKK",            60.567,  9.134,  166);
    INSERT_STATION(sql, 25110, "HEMSEDAL II",                 60.855,  8.593,  604);
    INSERT_STATION(sql, 25630, "GEILO - OLDEBRÅTEN",          60.530,  8.195,  772);
    INSERT_STATION(sql, 26900, "DRAMMEN - BERSKOG",           59.754, 10.124,    8);
    INSERT_STATION(sql, 26990, "SANDE - GALLEBERG",           59.619, 10.215,   60);
    INSERT_STATION(sql, 27010, "KONNERUD",                    59.713, 10.146,  193);
    INSERT_STATION(sql, 27270, "TØNSBERG - KILEN",            59.278, 10.431,    3);
    INSERT_STATION(sql, 27450, "MELSOM",                      59.230, 10.348,   26);
    INSERT_STATION(sql, 27470, "TORP",                        59.184, 10.255,   88);
    INSERT_STATION(sql, 27500, "FÆRDER FYR",                  59.027, 10.524,    6);
    INSERT_STATION(sql, 28380, "KONGSBERG BRANNSTASJON",      59.625,  9.638,  170);
    INSERT_STATION(sql, 28922, "VEGGLI II",                   60.044,  9.147,  275);
    INSERT_STATION(sql, 29720, "DAGALI LUFTHAVN",             60.416,  8.501,  798);
    INSERT_STATION(sql, 29950, "SVENNER FYR",                 58.969, 10.148,   15);
    INSERT_STATION(sql, 30420, "SKIEN - GEITERYGGEN",         59.183,  9.567,  136);
    INSERT_STATION(sql, 30650, "NOTODDEN FLYPLASS",           59.567,  9.210,   20);
    INSERT_STATION(sql, 31620, "MØSSTRAND II",                59.840,  8.179,  977);
    INSERT_STATION(sql, 32060, "GVARV - NES",                 59.382,  9.213,   93);
    INSERT_STATION(sql, 34130, "JOMFRULAND",                  58.856,  9.575,    5);
    ASSERT_NO_THROW_X(db->exec(sql.str()));
    DataList data(2650, 211, 330);
    data.add("2013-08-20 05:00:00",       4.8,       4.8, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       8.3,       8.3, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      10.9,      10.9, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      14.6,      14.6, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.3,      17.3, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.0,      18.0, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.7,      19.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.2,      20.2, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.8,      20.8, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.2,      20.2, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.2,      20.2, "0111100000100010", "");
    data.setType(502);
    data.setStation(3290)
        .add("2013-08-20 05:00:00",       5.6,       5.6, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       8.9,       8.9, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.9,      12.9, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.1,      16.1, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.4,      17.4, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      18.7,      18.7, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      18.8,      18.8, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      19.0,      19.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      18.0,      18.0, "0111100000100010", "");
    data.setType(342);
    data.setStation(4200)
        .add("2013-08-20 05:00:00",       7.4,       7.4, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      11.8,      11.8, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      14.6,      14.6, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.0,      16.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.2,      17.2, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.7,      18.7, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.1,      20.1, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.5,      20.5, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      21.1,      21.1, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      21.0,      21.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.8,      19.8, "0111100000100010", "");
    data.setStation(4460)
        .add("2013-08-20 05:00:00",       5.6,       5.6, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       8.2,       8.2, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.9,      12.9, "0131100000100010", "QC1-2-38")
        .add("2013-08-20 08:00:00",      16.8,      16.8, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      18.2,      18.2, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      19.5,      19.5, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.3,      20.3, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.2,      20.2, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.5,      19.5, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.1,      20.1, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.3,      19.3, "0111100000100010", "");
    data.setType(501);
    data.setStation(4780)
        .add("2013-08-20 05:00:00",       8.2,       8.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.7,      10.7, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.9,      12.9, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      15.1,      15.1, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.1,      17.1, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.2,      18.2, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      18.4,      18.4, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.1,      19.1, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.7,      19.7, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      19.8,      19.8, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.7,      19.7, "0111100000100010", "");
    data.setType(502);
    data.setStation(4920)
        .add("2013-08-20 05:00:00",       7.7,       7.7, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.9,      10.9, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      13.4,      13.4, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      15.2,      15.2, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      16.8,      16.8, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.4,      18.4, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.3,      19.3, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.7,      19.7, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.3,      20.3, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.2,      20.2, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.0,      19.0, "0111100000100010", "");
    data.setType(330);
    data.setStation(5590)
        .add("2013-08-20 05:00:00",       7.7,       7.7, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.4,      10.4, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.5,      12.5, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      14.7,      14.7, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.0,      17.0, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.2,      19.2, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.3,      20.3, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.6,      19.6, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.0,      20.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.8,      20.8, "0111100000100010", "");
    data.setType(502);
    data.setStation(5660)
        .add("2013-08-20 05:00:00",       6.7,       6.7, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.4,      10.4, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.3,      12.3, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      13.9,      13.9, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      15.8,      15.8, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.0,      17.0, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      18.2,      18.2, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.3,      19.3, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.4,      19.4, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      19.6,      19.6, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.6,      19.6, "0111100000100010", "");
    data.setType(330);
    data.setStation(6020)
        .add("2013-08-20 05:00:00",       7.2,       7.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       9.9,       9.9, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.1,      12.1, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      14.4,      14.4, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      16.0,      16.0, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.6,      17.6, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      18.7,      18.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.0,      20.0, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.9,      19.9, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.2,      20.2, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.9,      19.9, "0111100000100010", "");
    data.setType(502);
    data.setStation(11500)
        .add("2013-08-20 05:00:00",      10.2,      10.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      12.9,      12.9, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      14.8,      14.8, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.0,      16.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.7,      17.7, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.9,      18.9, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.1,      20.1, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.1,      19.1, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.7,      19.7, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      19.8,      19.8, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.5,      19.5, "0111100000100010", "");
    data.setType(342);
    data.setStation(12290)
        .add("2013-08-20 05:00:00",       6.2,       6.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       8.1,       8.1, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      11.5,      11.5, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      15.8,      15.8, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.4,      17.4, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.4,      18.4, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.6,      19.6, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      21.0,      21.0, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.5,      20.5, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.1,      20.1, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.3,      20.3, "0111100000100010", "");
    data.setType(330);
    data.setStation(12320)
        .add("2013-08-20 05:00:00",       7.8,       7.8, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.9,      10.9, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.8,      12.8, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      14.9,      14.9, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      16.3,      16.3, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.4,      17.4, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.4,      19.4, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.9,      19.9, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      19.6,      19.6, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.8,      19.8, "0111100000100010", "");
    data.setType(502);
    data.setStation(12550)
        .add("2013-08-20 05:00:00",      11.0,      11.0, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      13.2,      13.2, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      14.6,      14.6, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      17.5,      17.5, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      19.7,      19.7, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      21.3,      21.3, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      22.1,      22.1, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      21.1,      21.1, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.6,      20.6, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      22.0,      22.0, "0111100000100010", "");
    data.setType(330);
    data.setStation(12680)
        .add("2013-08-20 05:00:00",       6.4,       6.4, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       7.4,       7.4, "0111100000100010", "")
        .add("2013-08-20 07:00:00",       9.6,       9.6, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      12.1,      12.1, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      13.6,      13.6, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.9,      17.9, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.0,      19.0, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.1,      19.1, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.4,      19.4, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      18.2,      18.2, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      17.8,      17.8, "0111100000100010", "");
    data.setStation(17000)
        .add("2013-08-20 05:00:00",      15.2,      15.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      15.2,      15.2, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      15.7,      15.7, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.3,      16.3, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      16.4,      16.4, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.0,      17.0, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      17.5,      17.5, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      17.7,      17.7, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      18.0,      18.0, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      18.0,      18.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      18.0,      18.0, "0111100000100010", "");
    data.setType(342);
    data.setStation(17150)
        .add("2013-08-20 05:00:00",      11.5,      11.5, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      13.6,      13.6, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      15.0,      15.0, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.8,      16.8, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.7,      17.7, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.9,      18.9, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.4,      20.4, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.9,      19.9, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.9,      20.9, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.8,      20.8, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.5,      19.5, "0111100000100010", "");
    data.setType(330);
    data.setStation(17280)
        .add("2013-08-20 05:00:00",      13.4,      13.4, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      14.2,      14.2, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      15.0,      15.0, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.0,      16.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.0,      17.0, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.6,      18.6, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.0,      19.0, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.0,      19.0, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.6,      19.6, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.9,      20.9, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.3,      20.3, "0111100000100010", "");
    data.setStation(17850)
        .add("2013-08-20 05:00:00",       7.1,       7.1, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.0,      10.0, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      13.1,      13.1, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      15.5,      15.5, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      16.9,      16.9, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.9,      17.9, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      18.9,      18.9, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.4,      19.4, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.6,      19.6, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.0,      20.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.2,      19.2, "0111100000100010", "");
    data.setType(514);
    data.setStation(17980)
        .add("2013-08-20 05:00:00",       7.1,       7.1, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       9.5,       9.5, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      15.4,      15.4, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.7,      16.7, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      18.1,      18.1, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      20.1,      20.1, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      21.8,      21.8, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      22.7,      22.7, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.8,      20.8, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      19.8,      19.8, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      21.3,      21.3, "0111100000100010", "");
    data.setStation(18210)
        .add("2013-08-20 05:00:00",      14.6,      14.6, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      15.5,      15.5, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      17.1,      17.1, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      19.4,      19.4, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      19.6,      19.6, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.7,      20.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.8,      20.8, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.3,      20.3, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.2,      20.2, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      21.1,      21.1, "0111100000100010", "");
    data.setType(330);
    data.setStation(18230)
        .add("2013-08-20 05:00:00",      12.6,      10.6, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 06:00:00",      13.9,      11.8, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 07:00:00",      15.2,      13.9, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 08:00:00",      16.9,      16.0, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 09:00:00",      18.0,      17.9, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 10:00:00",      19.1,      18.9, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 11:00:00",      19.7,      19.7, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 12:00:00",      20.5,      20.0, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 13:00:00",      20.5,      20.5, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 14:00:00",      19.7,      21.0, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 15:00:00",      20.3,      21.1, "0010604000000600", "QC1-0-211,QC1-4-211");
    data.setType(342);
    data.setStation(18500)
        .add("2013-08-20 05:00:00",       4.8,       4.8, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       6.6,       6.6, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      10.3,      10.3, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      12.9,      12.9, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      14.6,      14.6, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      15.8,      15.8, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      16.7,      16.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",  -32767.0,      17.9, "0010601000100000", "QC1-4-211")
        .add("2013-08-20 13:00:00",      18.8,      18.8, "0110100000100010", "")
        .add("2013-08-20 14:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      17.7,      17.7, "0111100000100010", "");
    data.setType(330);
    data.setStation(18700)
        .add("2013-08-20 05:00:00",       8.6,       8.6, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      12.8,      12.8, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      14.8,      14.8, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.7,      16.7, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      20.5,      20.5, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.7,      20.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      21.4,      21.4, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.9,      20.9, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.9,      20.9, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.8,      19.8, "0111100000100010", "");
    data.setType(342);
    data.setStation(18815)
        .add("2013-08-20 05:00:00",       8.2,       8.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      13.1,      13.1, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      15.1,      15.1, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      17.2,      17.2, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      18.8,      18.8, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      20.4,      20.4, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.9,      20.9, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      21.9,      21.9, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      22.0,      22.0, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      21.2,      21.2, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      21.4,      21.4, "0111100000100010", "");
    data.setType(514);
    data.setStation(18815)
        .add("2013-08-20 05:00:00",      16.0,      16.0, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      16.6,      16.6, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      18.3,      18.3, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      19.9,      19.9, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      21.5,      21.5, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      22.2,      22.2, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      22.7,      22.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      22.9,      22.9, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      21.8,      21.8, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      22.6,      22.6, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      22.1,      22.1, "0111100000100010", "");
    data.setType(330);
    data.setStation(18950)
        .add("2013-08-20 05:00:00",       9.4,       9.4, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.6,      10.6, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      11.9,      11.9, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      13.5,      13.5, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      14.7,      14.7, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      15.4,      15.4, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      16.7,      16.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      17.2,      17.2, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      17.1,      17.1, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      17.2,      17.2, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      17.0,      17.0, "0111100000100010", "");
    data.setStation(20301)
        .add("2013-08-20 05:00:00",       7.4,       7.4, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       9.3,       9.3, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.9,      12.9, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      15.7,      15.7, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.4,      17.4, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.0,      18.0, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.3,      19.3, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.4,      20.4, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.3,      20.3, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.4,      20.4, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.6,      20.6, "0111100000100010", "");
    data.setType(311);
    data.setStation(23410)
        .add("2013-08-20 05:00:00",       7.5,       7.5, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       8.8,       8.8, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      10.0,      10.0, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      11.5,      11.5, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      11.0,      11.0, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      13.4,      13.4, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      12.7,      12.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      13.5,      13.5, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      12.7,      12.7, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      12.7,      12.7, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      12.6,      12.6, "0111100000100010", "");
    data.setType(330);
    data.setStation(23420)
        .add("2013-08-20 05:00:00",       5.7,       5.7, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       7.8,       7.8, "0111100000100010", "")
        .add("2013-08-20 07:00:00",       9.4,       9.4, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      11.6,      11.6, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      14.4,      14.4, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      16.1,      16.1, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      17.5,      17.5, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      17.1,      17.1, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      17.3,      17.3, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      18.3,      18.3, "0111100000100010", "");
    data.setType(502);
    data.setStation(23500)
        .add("2013-08-20 05:00:00",       6.8,       6.8, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       9.1,       9.1, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      11.5,      11.5, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      12.8,      12.8, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      12.8,      12.8, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      15.9,      15.9, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      15.7,      15.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      16.0,      16.0, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      15.3,      15.3, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      14.4,      14.4, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      15.4,      15.4, "0111100000100010", "");
    data.setType(342);
    data.setStation(24710)
        .add("2013-08-20 05:00:00",       6.5,       6.5, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       8.1,       8.1, "0131100000100010", "QC1-2-35")
        .add("2013-08-20 07:00:00",      11.8,      11.8, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      14.4,      14.4, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      15.0,      15.0, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      17.9,      17.9, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.3,      19.3, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.5,      19.5, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.5,      20.5, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      19.7,      19.7, "0111100000100010", "");
    data.setType(330);
    data.setStation(24890)
        .add("2013-08-20 05:00:00",       4.2,       4.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       5.3,       5.3, "0111100000100010", "")
        .add("2013-08-20 07:00:00",       9.8,       9.8, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      12.0,      12.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      13.0,      13.0, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.3,      17.3, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      18.6,      18.6, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      18.7,      18.7, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      19.3,      19.3, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      17.9,      17.9, "0111100000100010", "");
    data.setType(311);
    data.setStation(25110)
        .add("2013-08-20 05:00:00",       5.6,       5.6, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       7.1,       7.1, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      10.0,      10.0, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      11.4,      11.4, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      13.0,      13.0, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      15.1,      15.1, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      14.4,      14.4, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      14.2,      14.2, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      14.0,      14.0, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      14.0,      14.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      13.2,      13.2, "0111100000100010", "");
    data.setType(330);
    data.setStation(25630)
        .add("2013-08-20 05:00:00",       8.6,       8.6, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       9.6,       9.6, "0111100000100010", "")
        .add("2013-08-20 07:00:00",       9.7,       9.7, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      11.0,      11.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      11.2,      11.2, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      11.4,      11.4, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      11.3,      11.3, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      11.5,      11.5, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      11.0,      11.0, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      10.9,      10.9, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      11.8,      11.8, "0111100000100010", "");
    data.setStation(26900)
        .add("2013-08-20 05:00:00",       8.5,       8.5, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.7,      10.7, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      13.2,      13.2, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      15.0,      15.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      18.1,      18.1, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      19.9,      19.9, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      21.7,      21.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      22.4,      22.4, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      22.7,      22.7, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      22.5,      22.5, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      22.7,      22.7, "0111100000100010", "");
    data.setType(502);
    data.setStation(26990)
        .add("2013-08-20 05:00:00",       7.5,       7.5, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       9.8,       9.8, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      12.8,      12.8, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.4,      16.4, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      18.1,      18.1, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      19.3,      19.3, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.0,      20.0, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.2,      20.2, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.4,      20.4, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      21.0,      21.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      21.0,      21.0, "0111100000100010", "");
    data.setType(330);
    data.setStation(27010)
        .add("2013-08-20 05:00:00",       5.8,       5.8, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      10.2,      10.2, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      15.3,      15.3, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      17.2,      17.2, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      19.5,      19.5, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      20.6,      20.6, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.9,      20.9, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.7,      19.7, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.6,      20.6, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      21.1,      21.1, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.8,      20.8, "0111100000100010", "");
    data.setType(4);
    data.setStation(27270)
        .add("2013-08-20 05:00:00",      10.9,      10.2, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 06:00:00",      12.9,      11.8, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 07:00:00",      15.8,      14.2, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 08:00:00",      17.8,      16.4, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 09:00:00",      19.0,      18.0, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 10:00:00",      20.3,      19.0, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 11:00:00",      20.9,      19.8, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 12:00:00",      22.2,      20.6, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 13:00:00",      22.2,      21.0, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 14:00:00",      21.4,      20.8, "0010604000000600", "QC1-0-211,QC1-4-211")
        .add("2013-08-20 15:00:00",      22.3,      20.4, "0010604000000600", "QC1-0-211,QC1-4-211");
    data.setType(330);
    data.setStation(27450)
        .add("2013-08-20 05:00:00",       9.2,       9.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      11.1,      11.1, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      14.2,      14.2, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      16.7,      16.7, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.5,      17.5, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      19.2,      19.2, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      20.1,      20.1, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.7,      19.7, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.0,      20.0, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.8,      20.8, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.9,      20.9, "0111100000100010", "");
    data.setStation(27500)
        .add("2013-08-20 05:00:00",      14.3,      14.3, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      14.4,      14.4, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      14.7,      14.7, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      15.6,      15.6, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      16.5,      16.5, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.4,      17.4, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      18.0,      18.0, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      18.2,      18.2, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      18.7,      18.7, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      18.4,      18.4, "0111100000100010", "");
    data.setStation(28380)
        .add("2013-08-20 05:00:00",       6.5,       6.5, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       9.0,       9.0, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      10.9,      10.9, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      14.0,      14.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.9,      17.9, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      19.1,      19.1, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.4,      19.4, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      19.5,      19.5, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.8,      19.8, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      21.0,      21.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.9,      20.9, "0111100000100010", "");
    data.setStation(28922)
        .add("2013-08-20 05:00:00",       4.8,       4.8, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       7.6,       7.6, "0111100000100010", "")
        .add("2013-08-20 07:00:00",       9.7,       9.7, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      13.8,      13.8, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      15.6,      15.6, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.6,      18.6, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      18.1,      18.1, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      18.4,      18.4, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      19.0,      19.0, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      17.4,      17.4, "0111100000100010", "");
    data.setType(311);
    data.setStation(29720)
        .add("2013-08-20 05:00:00",       6.6,       6.6, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       7.7,       7.7, "0111100000100010", "")
        .add("2013-08-20 07:00:00",       9.7,       9.7, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      10.4,      10.4, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      11.5,      11.5, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      11.5,      11.5, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      12.1,      12.1, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      12.1,      12.1, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      12.2,      12.2, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      11.4,      11.4, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      11.7,      11.7, "0111100000100010", "");
    data.setType(330);
    data.setStation(29950)
        .add("2013-08-20 05:00:00",      13.2,      13.2, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      13.7,      13.7, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      14.3,      14.3, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      15.5,      15.5, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      16.2,      16.2, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.2,      17.2, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      18.2,      18.2, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      17.7,      17.7, "0111100000100010", "");
    data.setType(311);
    data.setStation(30420)
        .add("2013-08-20 05:00:00",       8.8,       8.8, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       9.7,       9.7, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      11.3,      11.3, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      14.0,      14.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      16.6,      16.6, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.0,      18.0, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.1,      19.1, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      18.5,      18.5, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      18.8,      18.8, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.4,      20.4, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.4,      20.4, "0111100000100010", "");
    data.setStation(30650)
        .add("2013-08-20 05:00:00",       5.1,       5.1, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       6.5,       6.5, "0111100000100010", "")
        .add("2013-08-20 07:00:00",       8.4,       8.4, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      11.5,      11.5, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      12.9,      12.9, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      17.3,      17.3, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.2,      19.2, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      20.3,      20.3, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      19.9,      19.9, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.9,      20.9, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.5,      20.5, "0111100000100010", "");
    data.setType(330);
    data.setStation(31620)
        .add("2013-08-20 05:00:00",       7.1,       7.1, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       8.0,       8.0, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      10.8,      10.8, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      10.8,      10.8, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      11.4,      11.4, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      12.3,      12.3, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      11.7,      11.7, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      11.2,      11.2, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      11.1,      11.1, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      10.6,      10.6, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      10.8,      10.8, "0111100000100010", "");
    data.setStation(32060)
        .add("2013-08-20 05:00:00",       6.7,       6.7, "0111100000100010", "")
        .add("2013-08-20 06:00:00",       8.3,       8.3, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      10.1,      10.1, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      13.4,      13.4, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      15.9,      15.9, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.9,      18.9, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.6,      19.6, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      21.1,      21.1, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      20.6,      20.6, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      20.8,      20.8, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      20.9,      20.9, "0111100000100010", "");
    data.setStation(34130)
        .add("2013-08-20 05:00:00",      12.8,      12.8, "0111100000100010", "")
        .add("2013-08-20 06:00:00",      13.9,      13.9, "0111100000100010", "")
        .add("2013-08-20 07:00:00",      15.5,      15.5, "0111100000100010", "")
        .add("2013-08-20 08:00:00",      17.0,      17.0, "0111100000100010", "")
        .add("2013-08-20 09:00:00",      17.8,      17.8, "0111100000100010", "")
        .add("2013-08-20 10:00:00",      18.7,      18.7, "0111100000100010", "")
        .add("2013-08-20 11:00:00",      19.5,      19.5, "0111100000100010", "")
        .add("2013-08-20 12:00:00",      18.6,      18.6, "0111100000100010", "")
        .add("2013-08-20 13:00:00",      18.6,      18.6, "0111100000100010", "")
        .add("2013-08-20 14:00:00",      18.1,      18.1, "0111100000100010", "")
        .add("2013-08-20 15:00:00",      17.9,      17.9, "0111100000100010", "");
    data.setStation(18500).setParam(213).setType(342);
    data.add("2013-08-20 05:00:00",       4.6,       4.6, "0111100000000010", "")
        .add("2013-08-20 06:00:00",       4.6,       4.6, "0111100000000010", "")
        .add("2013-08-20 07:00:00",       4.6,       4.6, "0111100000000010", "")
        .add("2013-08-20 08:00:00",       4.6,       4.6, "0111100000000010", "")
        .add("2013-08-20 09:00:00",       4.6,       4.6, "0113500000000010", "QC1-3b-213,QC1-4-213")
        .add("2013-08-20 10:00:00",       4.7,       4.7, "0111500000000010", "QC1-4-213")
        .add("2013-08-20 11:00:00",       5.5,       5.5, "0111500000000010", "QC1-4-213")
        .add("2013-08-20 12:00:00",       9.1,       9.1, "0111100000000010", "")
        .add("2013-08-20 13:00:00",      11.9,      11.9, "0111100000000010", "")
        .add("2013-08-20 14:00:00",      13.8,      13.8, "0111100000000010", "")
        .add("2013-08-20 15:00:00",      15.1,      15.1, "0111100000000010", "");
    data.setParam(215);
    data.add("2013-08-20 05:00:00",       6.0,       6.0, "0111100000000010", "")
        .add("2013-08-20 06:00:00",       6.6,       6.6, "0111100000000010", "")
        .add("2013-08-20 07:00:00",      10.3,      10.3, "0111100000000010", "")
        .add("2013-08-20 08:00:00",      12.9,      12.9, "0111100000000010", "")
        .add("2013-08-20 09:00:00",      14.6,      14.6, "0111100000000010", "")
        .add("2013-08-20 10:00:00",      15.8,      15.8, "0111100000000010", "")
        .add("2013-08-20 11:00:00",      16.7,      16.7, "0111100000000010", "")
        .add("2013-08-20 12:00:00",      17.8,      17.8, "0111100000000010", "")
        .add("2013-08-20 13:00:00",      18.8,      18.8, "0111100000000010", "")
        .add("2013-08-20 14:00:00",      18.9,      18.9, "0111100000000010", "")
        .add("2013-08-20 15:00:00",      18.9,      18.9, "0111100000000010", "");
    ASSERT_NO_THROW(data.insert(db));

    std::stringstream config;
    config << "Start_YYYY = 2013\n"
           << "Start_MM   =   08\n"
           << "Start_DD   =   20\n"
           << "Start_hh   =   05\n"
           << "End_YYYY   = 2013\n"
           << "End_MM     =   08\n"
           << "End_DD     =   20\n"
           << "End_hh     =   15\n"
           << "TypeId     = -32767\n"
           << "Parameter  = par=211,minPar=213,maxPar=215,minVal=-80,maxVal=100,offsetCorrectionLimit=15,fluctuationLevel=0\n";
    AlgorithmConfig params;
    params.Parse(config);
    ASSERT_CONFIGURE(algo, params);

    const int N = 3;
    ASSERT_RUN(algo, bc, N);
    const float expectedC[N] = { 14.9, 14.6, 15.8 }; // FIXME this is not a good interpolation!
    const float expectedP[N] = {  211,  213,  215 };
    for(int i=0; i<N; ++i) {
        EXPECT_NEAR(expectedC[i], bc->update(i).corrected(), i==0 ? 0.1 : 1) << "i=" << i;
        EXPECT_EQ(expectedP[i], bc->update(i).paramID()) << "i=" << i;
    }
    ASSERT_RUN(algo, bc, 0);
}
